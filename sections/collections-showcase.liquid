<section class="collections-showcase section-padding">
  <div class="container">
    {% if section.settings.heading %}
      <div class="section-header text-center mb-xl">
        {% if section.settings.tagline %}
          <p class="section-tagline">{{ section.settings.tagline }}</p>
        {% endif %}
        <h2 class="section-heading">{{ section.settings.heading }}</h2>
        {% if section.settings.description %}
          <p class="section-description">{{ section.settings.description }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="collections-grid">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'collection' %}
            {% assign collection = collections[block.settings.collection] %}
            <div class="collection-card collection-card--{{ block.settings.size }}" {{ block.shopify_attributes }}>
              <div class="collection-card__media">
                <a href="{{ collection.url | default: '#' }}" class="collection-card__link">
                  {% if block.settings.image %}
                    <img 
                      src="{{ block.settings.image | image_url: width: 800 }}" 
                      alt="{{ block.settings.image.alt | escape }}"
                      loading="lazy"
                      width="800"
                      height="{{ 800 | divided_by: block.settings.image.aspect_ratio }}"
                      class="collection-card__image"
                    >
                  {% elsif collection.featured_image %}
                    <img 
                      src="{{ collection.featured_image | image_url: width: 800 }}" 
                      alt="{{ collection.featured_image.alt | escape }}"
                      loading="lazy"
                      width="800"
                      height="{{ 800 | divided_by: collection.featured_image.aspect_ratio }}"
                      class="collection-card__image"
                    >
                  {% else %}
                    <div class="collection-card__placeholder">
                      {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
                    </div>
                  {% endif %}
                  
                  {% if block.settings.overlay_opacity > 0 %}
                    <div class="collection-card__overlay" style="opacity: {{ block.settings.overlay_opacity | divided_by: 100.0 }}"></div>
                  {% endif %}
                </a>

                <div class="collection-card__content">
                  {% if block.settings.custom_title %}
                    <h3 class="collection-card__title">{{ block.settings.custom_title }}</h3>
                  {% elsif collection.title %}
                    <h3 class="collection-card__title">{{ collection.title }}</h3>
                  {% else %}
                    <h3 class="collection-card__title">Collection Name</h3>
                  {% endif %}
                  
                  {% if block.settings.description %}
                    <p class="collection-card__description">{{ block.settings.description }}</p>
                  {% elsif collection.description %}
                    <p class="collection-card__description">{{ collection.description | truncate: 100 }}</p>
                  {% endif %}
                  
                  {% if collection.products_count > 0 %}
                    <p class="collection-card__count">{{ collection.products_count }} items</p>
                  {% endif %}
                  
                  <div class="collection-card__button">
                    <span class="btn btn--secondary">
                      {% if block.settings.button_label %}
                        {{ block.settings.button_label }}
                      {% else %}
                        Shop Now
                      {% endif %}
                    </span>
                  </div>
                </div>
              </div>
            </div>
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</section>

{% stylesheet %}
  .collections-showcase {
    background-color: var(--color-background);
  }

  .collections-grid {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    gap: var(--spacing-lg);
    min-height: 600px;
  }

  /* Collection Card */
  .collection-card {
    position: relative;
    border-radius: var(--radius-large);
    overflow: hidden;
    transition: var(--transition-medium);
  }

  .collection-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-heavy);
  }

  /* Size variations */
  .collection-card--small {
    grid-column: span 3;
  }

  .collection-card--medium {
    grid-column: span 4;
  }

  .collection-card--large {
    grid-column: span 6;
  }

  .collection-card--full {
    grid-column: span 12;
  }

  .collection-card__media {
    position: relative;
    height: 100%;
    min-height: 300px;
    background-color: var(--color-border);
  }

  .collection-card__link {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  .collection-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: var(--transition-slow);
  }

  .collection-card:hover .collection-card__image {
    transform: scale(1.05);
  }

  .collection-card__placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-border);
  }

  .collection-card__placeholder svg {
    width: 100px;
    height: 100px;
    opacity: 0.5;
  }

  .collection-card__overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #000;
    z-index: 2;
  }

  .collection-card__content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: var(--spacing-xl);
    color: white;
    z-index: 3;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
  }

  .collection-card__title {
    font-size: clamp(1.25rem, 3vw, 2rem);
    font-weight: var(--font-heading--weight);
    margin-bottom: var(--spacing-sm);
    line-height: 1.2;
  }

  .collection-card__description {
    font-size: 1rem;
    line-height: 1.5;
    margin-bottom: var(--spacing-sm);
    opacity: 0.9;
  }

  .collection-card__count {
    font-size: 0.875rem;
    opacity: 0.8;
    margin-bottom: var(--spacing-md);
  }

  .collection-card__button {
    opacity: 0;
    transform: translateY(20px);
    transition: var(--transition-medium);
  }

  .collection-card:hover .collection-card__button {
    opacity: 1;
    transform: translateY(0);
  }

  .collection-card__button .btn {
    border-color: white;
    color: white;
    background-color: transparent;
  }

  .collection-card__button .btn:hover {
    background-color: white;
    color: var(--color-text);
  }

  /* Light content variation */
  .collection-card--light .collection-card__content {
    color: var(--color-text);
    background: linear-gradient(transparent, rgba(255, 255, 255, 0.9));
  }

  .collection-card--light .collection-card__button .btn {
    border-color: var(--color-text);
    color: var(--color-text);
  }

  .collection-card--light .collection-card__button .btn:hover {
    background-color: var(--color-text);
    color: white;
  }

  /* Responsive Design */
  @media (max-width: 1024px) {
    .collection-card--small,
    .collection-card--medium {
      grid-column: span 6;
    }

    .collection-card--large {
      grid-column: span 12;
    }
  }

  @media (max-width: 768px) {
    .collections-grid {
      grid-template-columns: 1fr;
      gap: var(--spacing-md);
    }

    .collection-card--small,
    .collection-card--medium,
    .collection-card--large,
    .collection-card--full {
      grid-column: span 1;
    }

    .collection-card__media {
      min-height: 250px;
    }

    .collection-card__content {
      padding: var(--spacing-lg);
    }

    .collection-card__button {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (max-width: 480px) {
    .collection-card__media {
      min-height: 200px;
    }

    .collection-card__content {
      padding: var(--spacing-md);
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Collections Showcase",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "tagline",
      "label": "Tagline",
      "default": "Shop by"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Our Collections"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Explore our curated collections of premium streetwear essentials."
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Custom Image"
        },
        {
          "type": "text",
          "id": "custom_title",
          "label": "Custom Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Custom Description"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button Label",
          "default": "Shop Now"
        },
        {
          "type": "select",
          "id": "size",
          "label": "Card Size",
          "options": [
            {
              "value": "small",
              "label": "Small"
            },
            {
              "value": "medium",
              "label": "Medium"
            },
            {
              "value": "large",
              "label": "Large"
            },
            {
              "value": "full",
              "label": "Full Width"
            }
          ],
          "default": "medium"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "min": 0,
          "max": 80,
          "step": 5,
          "unit": "%",
          "label": "Overlay Opacity",
          "default": 30
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collections Showcase",
      "settings": {
        "tagline": "Shop by",
        "heading": "Our Collections",
        "description": "Explore our curated collections of premium streetwear essentials."
      },
      "blocks": [
        {
          "type": "collection",
          "settings": {
            "size": "large",
            "custom_title": "T-Shirts & Tops",
            "button_label": "Shop Tops"
          }
        },
        {
          "type": "collection",
          "settings": {
            "size": "medium",
            "custom_title": "Hoodies",
            "button_label": "Shop Hoodies"
          }
        },
        {
          "type": "collection",
          "settings": {
            "size": "medium",
            "custom_title": "Accessories",
            "button_label": "Shop Accessories"
          }
        }
      ]
    }
  ]
}
{% endschema %}
